<!DOCTYPE html><html class="default" lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>@microsoft/live-share-react | Microsoft Live Share SDK</title><meta name="description" content="Documentation for Microsoft Live Share SDK"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/search.js" id="tsd-search-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os"</script><header class="tsd-page-toolbar">
<div class="tsd-toolbar-contents container">
<div class="table-cell" id="tsd-search" data-base="..">
<div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M15.7824 13.833L12.6666 10.7177C12.5259 10.5771 12.3353 10.499 12.1353 10.499H11.6259C12.4884 9.39596 13.001 8.00859 13.001 6.49937C13.001 2.90909 10.0914 0 6.50048 0C2.90959 0 0 2.90909 0 6.49937C0 10.0896 2.90959 12.9987 6.50048 12.9987C8.00996 12.9987 9.39756 12.4863 10.5008 11.6239V12.1332C10.5008 12.3332 10.5789 12.5238 10.7195 12.6644L13.8354 15.7797C14.1292 16.0734 14.6042 16.0734 14.8948 15.7797L15.7793 14.8954C16.0731 14.6017 16.0731 14.1267 15.7824 13.833ZM6.50048 10.499C4.29094 10.499 2.50018 8.71165 2.50018 6.49937C2.50018 4.29021 4.28781 2.49976 6.50048 2.49976C8.71001 2.49976 10.5008 4.28708 10.5008 6.49937C10.5008 8.70852 8.71314 10.499 6.50048 10.499Z" fill="var(--color-text)"></path></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div>
<div class="field">
<div id="tsd-toolbar-links"></div></div>
<ul class="results">
<li class="state loading">Preparing search index...</li>
<li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">Microsoft Live Share SDK</a></div>
<div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><rect x="1" y="3" width="14" height="2" fill="var(--color-text)"></rect><rect x="1" y="7" width="14" height="2" fill="var(--color-text)"></rect><rect x="1" y="11" width="14" height="2" fill="var(--color-text)"></rect></svg></a></div></div></header>
<div class="container container-main">
<div class="col-content">
<div class="tsd-page-title">
<ul class="tsd-breadcrumb">
<li><a href="../index.html">Microsoft Live Share SDK</a></li>
<li><a href="_microsoft_live_share_react.html">@microsoft/live-share-react</a></li></ul>
<h1>Module @microsoft/live-share-react</h1></div>
<section class="tsd-panel tsd-typography"><a id="md:live-share-react" class="tsd-anchor"></a><h1><a href="#md:live-share-react">Live Share React</a></h1><p>Live Share React is designed to make building collaborative apps in React simple and intuitive, all using familiar patterns from functional React.</p>
<p>Here is a simple example of how to get started:</p>
<pre><code class="language-javascript"><span class="hl-6">// LiveShareApp.jsx</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">LiveShareProvider</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@microsoft/live-share-react&quot;</span><span class="hl-1">;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">LiveShareHost</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@microsoft/teams-js&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-7">host</span><span class="hl-1"> = </span><span class="hl-5">LiveShareHost</span><span class="hl-1">.</span><span class="hl-0">create</span><span class="hl-1">();</span><br/><br/><span class="hl-4">export</span><span class="hl-1"> </span><span class="hl-3">function</span><span class="hl-1"> </span><span class="hl-0">LiveShareApp</span><span class="hl-1">() {</span><br/><span class="hl-1">  </span><span class="hl-6">// Call app.initialize() from teams-js before rendering LiveShareProvider</span><br/><br/><span class="hl-1">  </span><span class="hl-4">return</span><span class="hl-1"> (</span><br/><span class="hl-1">    </span><span class="hl-8">&lt;</span><span class="hl-12">LiveShareProvider</span><br/><span class="hl-1">      </span><span class="hl-10">joinOnLoad</span><span class="hl-1">=</span><span class="hl-3">{true}</span><br/><span class="hl-1">      </span><span class="hl-10">host</span><span class="hl-1">=</span><span class="hl-3">{</span><span class="hl-5">host</span><span class="hl-3">}</span><br/><span class="hl-1">    </span><span class="hl-8">&gt;</span><br/><span class="hl-1">      </span><span class="hl-8">&lt;</span><span class="hl-12">SharedCheckbox</span><span class="hl-1"> </span><span class="hl-8">/&gt;</span><br/><span class="hl-1">    </span><span class="hl-8">&lt;/</span><span class="hl-12">LiveShareProvider</span><span class="hl-8">&gt;</span><br/><span class="hl-1">  );</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-6">// SharedCheckbox.jsx</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">useSharedState</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@microsoft/live-share-react&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">export</span><span class="hl-1"> </span><span class="hl-3">function</span><span class="hl-1"> </span><span class="hl-0">SharedCheckbox</span><span class="hl-1">() {</span><br/><span class="hl-1">  </span><span class="hl-3">const</span><span class="hl-1"> [</span><span class="hl-7">checked</span><span class="hl-1">, </span><span class="hl-7">setChecked</span><span class="hl-1">] = </span><span class="hl-0">useSharedState</span><span class="hl-1">(</span><span class="hl-2">&quot;MY-UNIQUE-ID&quot;</span><span class="hl-1">, </span><span class="hl-3">false</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">return</span><span class="hl-1"> (</span><br/><span class="hl-1">    </span><span class="hl-8">&lt;</span><span class="hl-9">input</span><br/><span class="hl-1">      </span><span class="hl-10">type</span><span class="hl-1">=</span><span class="hl-2">&quot;checkbox&quot;</span><br/><span class="hl-1">      </span><span class="hl-10">checked</span><span class="hl-1">=</span><span class="hl-3">{</span><span class="hl-5">checked</span><span class="hl-3">}</span><br/><span class="hl-1">      </span><span class="hl-10">onChange</span><span class="hl-1">=</span><span class="hl-3">{</span><span class="hl-14">() </span><span class="hl-3">=&gt;</span><span class="hl-14"> {</span><br/><span class="hl-14">        </span><span class="hl-0">setChecked</span><span class="hl-14">(</span><span class="hl-1">!</span><span class="hl-5">checked</span><span class="hl-14">);</span><br/><span class="hl-14">      }</span><span class="hl-3">}</span><br/><span class="hl-1">    </span><span class="hl-8">/&gt;</span><br/><span class="hl-1">  );</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<a id="md:getting-started" class="tsd-anchor"></a><h2><a href="#md:getting-started">Getting started</a></h2><a id="md:installing" class="tsd-anchor"></a><h2><a href="#md:installing">Installing</a></h2><p>To add the latest version of the SDK to your application using NPM:</p>
<pre><code class="language-bash"><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-2">fluid-framework</span><span class="hl-1"> </span><span class="hl-2">@fluidframework/azure-client</span><span class="hl-1"> </span><span class="hl-2">@microsoft/live-share</span><span class="hl-1"> </span><span class="hl-2">@microsoft/live-share-media</span><span class="hl-1"> </span><span class="hl-2">@microsoft/live-share-canvas</span><span class="hl-1"> </span><span class="hl-2">@microsoft/live-share-react</span><span class="hl-1"> </span><span class="hl-3">--save</span>
</code><button>Copy</button></pre>
<p>or using <a href="https://yarnpkg.com/">Yarn</a>:</p>
<pre><code class="language-bash"><span class="hl-0">yarn</span><span class="hl-1"> </span><span class="hl-2">add</span><span class="hl-1"> </span><span class="hl-2">fluid-framework</span><span class="hl-1"> </span><span class="hl-2">@fluidframework/azure-client</span><span class="hl-1"> </span><span class="hl-2">@microsoft/live-share</span><span class="hl-1"> </span><span class="hl-2">@microsoft/live-share-media</span><span class="hl-1"> </span><span class="hl-2">@microsoft/live-share-canvas</span><span class="hl-1"> </span><span class="hl-2">@microsoft/live-share-react</span>
</code><button>Copy</button></pre>
<a id="md:building-package" class="tsd-anchor"></a><h3><a href="#md:building-package">Building package</a></h3><p>After cloning the <a href="https://www.github.com/microsoft/live-share-sdk">GitHub repository</a>, navigate to the root folder and perform:</p>
<pre><code class="language-bash"><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><br/><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">run</span><span class="hl-1"> </span><span class="hl-2">build</span>
</code><button>Copy</button></pre>
<p>This will use npm workspaces to hoist and build all dependencies.</p>
<a id="md:sample-app" class="tsd-anchor"></a><h3><a href="#md:sample-app">Sample app</a></h3><p>After installing/building the packages, you can also try out a <a href="../../samples/04.live-share-react/">working sample here</a>.</p>
<a id="md:live-share-react-vs-vanilla-fluid" class="tsd-anchor"></a><h2><a href="#md:live-share-react-vs-vanilla-fluid">Live Share React vs. Vanilla Fluid</a></h2><p>Fluid Framework and Live Share are powerful frameworks that can greatly simplify the effort of building collaborative applications, but for many React applications, it can take time to get used to. This experimental package aims to strip away as much of that learning curve as possible.</p>
<p>Where traditional Fluid utilizes a developer-defined object schema with a hierarchal structure, this package abstracts that out on your behalf. While you can still tap into more complicated hierarchies with this library, it is designed to behave more like blob storage / NoSQL.</p>
<p>To use Fluid&#39;s distributed-data structures (DDS) or Live Share&#39;s live objects, you can simply use the corresponding React hook, providing a unique identifier for that DDS. If no DDS exists when the component is first mounted, we automatically create one for you. Otherwise, we will connect to the existing one.</p>
<p>Much like React itself, this package is opinionated, and it may not be for everyone. To learn more about using Live Share the traditional way, see our <a href="../live-share/README.md">Live Share README</a>.</p>
<a id="md:types-of-hooks" class="tsd-anchor"></a><h2><a href="#md:types-of-hooks">Types of hooks</a></h2><p>Live Share supports all of the live data structures provided through Live Share, and most of the officially supported DDS&#39;s available through Fluid Framework. If you have custom data objects, this package also exposes some underlying APIs for building your own custom React hooks.</p>
<p>Here are the hooks provided by this library:</p>
<a id="md:usesharedstate" class="tsd-anchor"></a><h3><a href="#md:usesharedstate">useSharedState</a></h3><p>Inspired by React&#39;s own <code>useState</code> hook, <code>useSharedState</code> should feel familiar to React developers. Under the hood, this hook uses a Fluid <code>SharedMap</code> dedicated for <code>useSharedState</code>, listening for changes to the key provided and automatically updating the shared state with any changes. And yes, if two components in the same application use the same key, those components will be in sync with each other!</p>
<p>Since these keys are a <code>string</code> you provide while calling <code>useSharedState</code>, you can dynamically load these into your app as needed. With this in mind, we&#39;ve also provided an optional <code>disposeState</code> action if the state is no longer relevant to your app. If you don&#39;t dispose it, then the data will persist in the container should you access it later (up to the lifetime of the Fluid container).</p>
<p>The following example shows how <code>useSharedState</code> can be used to dynamically create collaborative features in your app on the fly:</p>
<pre><code class="language-javascript"><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">useSharedState</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@microsoft/live-share-react&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">export</span><span class="hl-1"> </span><span class="hl-3">function</span><span class="hl-1"> </span><span class="hl-0">CounterCard</span><span class="hl-1">({ </span><span class="hl-5">card</span><span class="hl-1">, </span><span class="hl-5">onDelete</span><span class="hl-1"> }) {</span><br/><span class="hl-1">  </span><span class="hl-3">const</span><span class="hl-1"> [</span><span class="hl-7">count</span><span class="hl-1">, </span><span class="hl-7">setCount</span><span class="hl-1">, </span><span class="hl-7">disposeCount</span><span class="hl-1">] = </span><span class="hl-0">useSharedState</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-2">`card-count:</span><span class="hl-3">${</span><span class="hl-5">card</span><span class="hl-14">.</span><span class="hl-5">id</span><span class="hl-3">}</span><span class="hl-2">`</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-13">0</span><br/><span class="hl-1">  );</span><br/><span class="hl-1">  </span><span class="hl-4">return</span><span class="hl-1"> (</span><br/><span class="hl-1">    </span><span class="hl-8">&lt;</span><span class="hl-9">div</span><span class="hl-1"> </span><span class="hl-10">className</span><span class="hl-1">=</span><span class="hl-2">&quot;card&quot;</span><span class="hl-8">&gt;</span><br/><span class="hl-1">      </span><span class="hl-8">&lt;</span><span class="hl-9">h3</span><span class="hl-8">&gt;</span><span class="hl-3">{</span><span class="hl-5">card</span><span class="hl-14">.</span><span class="hl-5">title</span><span class="hl-3">}</span><span class="hl-8">&lt;/</span><span class="hl-9">h3</span><span class="hl-8">&gt;</span><br/><span class="hl-1">      </span><span class="hl-8">&lt;</span><span class="hl-9">button</span><br/><span class="hl-1">        </span><span class="hl-10">onClick</span><span class="hl-1">=</span><span class="hl-3">{</span><span class="hl-14">() </span><span class="hl-3">=&gt;</span><span class="hl-14"> {</span><br/><span class="hl-14">          </span><span class="hl-0">setCount</span><span class="hl-14">(</span><span class="hl-5">count</span><span class="hl-14"> </span><span class="hl-1">+</span><span class="hl-14"> </span><span class="hl-13">1</span><span class="hl-14">);</span><br/><span class="hl-14">        }</span><span class="hl-3">}</span><br/><span class="hl-1">      </span><span class="hl-8">&gt;</span><br/><span class="hl-1">        </span><span class="hl-3">{</span><span class="hl-2">&quot;+1&quot;</span><span class="hl-3">}</span><br/><span class="hl-1">      </span><span class="hl-8">&lt;/</span><span class="hl-9">button</span><span class="hl-8">&gt;</span><br/><span class="hl-1">      </span><span class="hl-8">&lt;</span><span class="hl-9">span</span><span class="hl-8">&gt;</span><span class="hl-3">{</span><span class="hl-2">`</span><span class="hl-3">${</span><span class="hl-5">count</span><span class="hl-3">}</span><span class="hl-2"> `</span><span class="hl-3">}</span><span class="hl-8">&lt;/</span><span class="hl-9">span</span><span class="hl-8">&gt;</span><br/><span class="hl-1">      </span><span class="hl-8">&lt;</span><span class="hl-9">button</span><br/><span class="hl-1">        </span><span class="hl-10">onClick</span><span class="hl-1">=</span><span class="hl-3">{</span><span class="hl-14">() </span><span class="hl-3">=&gt;</span><span class="hl-14"> {</span><br/><span class="hl-14">          </span><span class="hl-0">onDelete</span><span class="hl-14">(</span><span class="hl-5">card</span><span class="hl-14">.</span><span class="hl-5">id</span><span class="hl-14">);</span><br/><span class="hl-14">          </span><span class="hl-0">disposeCount</span><span class="hl-14">();</span><br/><span class="hl-14">        }</span><span class="hl-3">}</span><br/><span class="hl-1">      </span><span class="hl-8">&gt;</span><br/><span class="hl-1">        </span><span class="hl-3">{</span><span class="hl-2">&quot;Delete&quot;</span><span class="hl-3">}</span><br/><span class="hl-1">      </span><span class="hl-8">&lt;/</span><span class="hl-9">button</span><span class="hl-8">&gt;</span><br/><span class="hl-1">    </span><span class="hl-8">&lt;/</span><span class="hl-9">div</span><span class="hl-8">&gt;</span><br/><span class="hl-1">  );</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<p><em>NOTE:</em> While this hook will get you pretty far on its own, carefully consider which of our React hook is best for your scenario.</p>
<a id="md:usesharedmap" class="tsd-anchor"></a><h3><a href="#md:usesharedmap">useSharedMap</a></h3><p>This hook loads a Fluid <code>SharedMap</code> corresponding with the key you provide. Compared to <code>useSharedState</code>, this hook allows you to render a collection of items with less risk of conflict when multiple users may be writing to the same object simultaneously. For example, rather than storing an entire list of objects in a single key of <code>useSharedState</code>, the map allows each item in the list to have its own unique key.</p>
<p>While you write to keys individually, the <code>map</code> object exposed through the hook uses React state itself. Lets see an example in action:</p>
<pre><code class="language-javascript"><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">useSharedMap</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@microsoft/live-share-react&quot;</span><span class="hl-1">;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">v4</span><span class="hl-1"> </span><span class="hl-4">as</span><span class="hl-1"> </span><span class="hl-5">uuid</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&quot;uuid&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">export</span><span class="hl-1"> </span><span class="hl-3">function</span><span class="hl-1"> </span><span class="hl-0">CardList</span><span class="hl-1">() {</span><br/><span class="hl-1">  </span><span class="hl-3">const</span><span class="hl-1"> { </span><span class="hl-7">map</span><span class="hl-1">, </span><span class="hl-7">setEntry</span><span class="hl-1">, </span><span class="hl-7">deleteEntry</span><span class="hl-1"> } = </span><span class="hl-0">useSharedMap</span><span class="hl-1">(</span><span class="hl-2">&quot;CUSTOM-MAP-ID&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">return</span><span class="hl-1"> (</span><br/><span class="hl-1">    </span><span class="hl-8">&lt;</span><span class="hl-9">div</span><span class="hl-8">&gt;</span><br/><span class="hl-1">      </span><span class="hl-8">&lt;</span><span class="hl-9">h2</span><span class="hl-8">&gt;</span><span class="hl-3">{</span><span class="hl-2">&quot;Cards&quot;</span><span class="hl-3">}</span><span class="hl-8">&lt;/</span><span class="hl-9">h2</span><span class="hl-8">&gt;</span><br/><span class="hl-1">      </span><span class="hl-8">&lt;</span><span class="hl-9">button</span><br/><span class="hl-1">        </span><span class="hl-10">onClick</span><span class="hl-1">=</span><span class="hl-3">{</span><span class="hl-14">() </span><span class="hl-3">=&gt;</span><span class="hl-14"> {</span><br/><span class="hl-14">          </span><span class="hl-3">const</span><span class="hl-14"> </span><span class="hl-7">id</span><span class="hl-14"> </span><span class="hl-1">=</span><span class="hl-14"> </span><span class="hl-0">uuid</span><span class="hl-14">();</span><br/><span class="hl-14">          </span><span class="hl-0">setEntry</span><span class="hl-14">(</span><span class="hl-5">id</span><span class="hl-14">, {</span><br/><span class="hl-14">            </span><span class="hl-5">id</span><span class="hl-14">,</span><br/><span class="hl-14">            </span><span class="hl-5">title:</span><span class="hl-14"> </span><span class="hl-2">&quot;Custom Card&quot;</span><span class="hl-14">,</span><br/><span class="hl-14">          });</span><br/><span class="hl-14">        }</span><span class="hl-3">}</span><br/><span class="hl-1">      </span><span class="hl-8">&gt;</span><br/><span class="hl-1">        </span><span class="hl-3">{</span><span class="hl-2">&quot;+ Add card&quot;</span><span class="hl-3">}</span><br/><span class="hl-1">      </span><span class="hl-8">&lt;/</span><span class="hl-9">button</span><span class="hl-8">&gt;</span><br/><span class="hl-1">      </span><span class="hl-8">&lt;</span><span class="hl-9">div</span><span class="hl-1"> </span><span class="hl-10">className</span><span class="hl-1">=</span><span class="hl-2">&quot;flex wrap row hAlign&quot;</span><span class="hl-8">&gt;</span><br/><span class="hl-1">        </span><span class="hl-3">{</span><span class="hl-14">[</span><span class="hl-1">...</span><span class="hl-5">map</span><span class="hl-14">.</span><span class="hl-0">values</span><span class="hl-14">()].</span><span class="hl-0">map</span><span class="hl-14">((</span><span class="hl-5">cardValue</span><span class="hl-14">) </span><span class="hl-3">=&gt;</span><span class="hl-14"> (</span><br/><span class="hl-14">          </span><span class="hl-8">&lt;</span><span class="hl-12">CounterCard</span><br/><span class="hl-14">            </span><span class="hl-10">key</span><span class="hl-1">=</span><span class="hl-3">{</span><span class="hl-5">cardValue</span><span class="hl-14">.</span><span class="hl-5">id</span><span class="hl-3">}</span><br/><span class="hl-14">            </span><span class="hl-10">card</span><span class="hl-1">=</span><span class="hl-3">{</span><span class="hl-5">cardValue</span><span class="hl-3">}</span><br/><span class="hl-14">            </span><span class="hl-10">onDelete</span><span class="hl-1">=</span><span class="hl-3">{</span><span class="hl-5">deleteEntry</span><span class="hl-3">}</span><br/><span class="hl-14">          </span><span class="hl-8">/&gt;</span><br/><span class="hl-14">        ))</span><span class="hl-3">}</span><br/><span class="hl-1">      </span><span class="hl-8">&lt;/</span><span class="hl-9">div</span><span class="hl-8">&gt;</span><br/><span class="hl-1">    </span><span class="hl-8">&lt;/</span><span class="hl-9">div</span><span class="hl-8">&gt;</span><br/><span class="hl-1">  );</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<a id="md:uselivepresence" class="tsd-anchor"></a><h3><a href="#md:uselivepresence">useLivePresence</a></h3><p>Presence makes it easy to track which users are currently in the session and assign custom data to them.</p>
<pre><code class="language-javascript"><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">useLivePresence</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@microsoft/live-share-react&quot;</span><span class="hl-1">;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">PresenceState</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@microsoft/live-share&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">export</span><span class="hl-1"> </span><span class="hl-3">function</span><span class="hl-1"> </span><span class="hl-0">OnlineUsers</span><span class="hl-1">() {</span><br/><span class="hl-1">  </span><span class="hl-3">const</span><span class="hl-1"> { </span><span class="hl-7">localUser</span><span class="hl-1">, </span><span class="hl-7">allUsers</span><span class="hl-1">, </span><span class="hl-7">updatePresence</span><span class="hl-1"> } = </span><span class="hl-0">useLivePresence</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;UNIQUE-PRESENCE-KEY&quot;</span><span class="hl-1">, </span><span class="hl-6">// required unique key for presence</span><br/><span class="hl-1">    { </span><span class="hl-5">favoriteColor:</span><span class="hl-1"> </span><span class="hl-2">&quot;red&quot;</span><span class="hl-1"> } </span><span class="hl-6">// optional custom data object</span><br/><span class="hl-1">  );</span><br/><span class="hl-1">  </span><span class="hl-4">return</span><span class="hl-1"> (</span><br/><span class="hl-1">    </span><span class="hl-8">&lt;</span><span class="hl-9">div</span><span class="hl-8">&gt;</span><br/><span class="hl-1">      </span><span class="hl-8">&lt;</span><span class="hl-9">h1</span><span class="hl-8">&gt;</span><span class="hl-3">{</span><span class="hl-2">&quot;Online Users:&quot;</span><span class="hl-3">}</span><span class="hl-8">&lt;/</span><span class="hl-9">h1</span><span class="hl-8">&gt;</span><br/><span class="hl-1">      </span><span class="hl-8">&lt;</span><span class="hl-9">div</span><span class="hl-8">&gt;</span><br/><span class="hl-1">        </span><span class="hl-3">{</span><span class="hl-5">allUsers</span><br/><span class="hl-14">          .</span><span class="hl-0">filter</span><span class="hl-14">((</span><span class="hl-5">user</span><span class="hl-14">) </span><span class="hl-3">=&gt;</span><span class="hl-14"> </span><span class="hl-5">user</span><span class="hl-14">.</span><span class="hl-5">state</span><span class="hl-14"> </span><span class="hl-1">===</span><span class="hl-14"> </span><span class="hl-5">PresenceState</span><span class="hl-14">.</span><span class="hl-5">online</span><span class="hl-14">)</span><br/><span class="hl-14">          .</span><span class="hl-0">map</span><span class="hl-14">((</span><span class="hl-5">user</span><span class="hl-14">) </span><span class="hl-3">=&gt;</span><span class="hl-14"> (</span><br/><span class="hl-14">            </span><span class="hl-8">&lt;</span><span class="hl-9">div</span><span class="hl-14"> </span><span class="hl-10">key</span><span class="hl-1">=</span><span class="hl-3">{</span><span class="hl-5">user</span><span class="hl-14">.</span><span class="hl-5">userId</span><span class="hl-3">}</span><span class="hl-8">&gt;</span><br/><span class="hl-14">                </span><span class="hl-3">{</span><span class="hl-5">user</span><span class="hl-14">.</span><span class="hl-5">displayName</span><span class="hl-14"> </span><span class="hl-1">+</span><span class="hl-14"> </span><span class="hl-2">&quot; &quot;</span><span class="hl-14"> </span><span class="hl-1">+</span><span class="hl-14"> </span><span class="hl-5">user</span><span class="hl-14">.</span><span class="hl-5">data</span><span class="hl-1">!</span><span class="hl-14">.</span><span class="hl-5">favoriteColor</span><span class="hl-3">}</span><br/><span class="hl-14">            </span><span class="hl-8">&lt;/</span><span class="hl-9">div</span><span class="hl-8">&gt;</span><br/><span class="hl-14">          ))</span><span class="hl-3">}</span><br/><span class="hl-1">      </span><span class="hl-8">&lt;/</span><span class="hl-9">div</span><span class="hl-8">&gt;</span><br/><span class="hl-1">      </span><span class="hl-8">&lt;</span><span class="hl-9">button</span><br/><span class="hl-1">        </span><span class="hl-10">onClick</span><span class="hl-1">=</span><span class="hl-3">{</span><span class="hl-14">() </span><span class="hl-3">=&gt;</span><span class="hl-14"> {</span><br/><span class="hl-14">          </span><span class="hl-0">updatePresence</span><span class="hl-14">(</span><br/><span class="hl-14">            </span><span class="hl-5">localUser</span><span class="hl-14">.</span><span class="hl-5">data</span><span class="hl-14">,</span><br/><span class="hl-14">            </span><span class="hl-5">localUser</span><span class="hl-14">?.</span><span class="hl-5">state</span><span class="hl-14"> </span><span class="hl-1">===</span><span class="hl-14"> </span><span class="hl-5">PresenceState</span><span class="hl-14">.</span><span class="hl-5">offline</span><br/><span class="hl-14">              </span><span class="hl-1">?</span><span class="hl-14"> </span><span class="hl-5">PresenceState</span><span class="hl-14">.</span><span class="hl-5">online</span><br/><span class="hl-14">              </span><span class="hl-1">:</span><span class="hl-14"> </span><span class="hl-5">PresenceState</span><span class="hl-14">.</span><span class="hl-5">offline</span><span class="hl-14">,</span><br/><span class="hl-14">          );</span><br/><span class="hl-14">        }</span><span class="hl-3">}</span><br/><span class="hl-1">      </span><span class="hl-8">&gt;</span><br/><span class="hl-1">        </span><span class="hl-3">{</span><span class="hl-2">`Toggle status`</span><span class="hl-3">}</span><br/><span class="hl-1">      </span><span class="hl-8">&lt;/</span><span class="hl-9">button</span><span class="hl-8">&gt;</span><br/><span class="hl-1">    </span><span class="hl-8">&lt;/</span><span class="hl-9">div</span><span class="hl-8">&gt;</span><br/><span class="hl-1">  );</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<a id="md:uselivestate" class="tsd-anchor"></a><h3><a href="#md:uselivestate">useLiveState</a></h3><p>Unlike <code>useSharedState</code>, <code>useLiveState</code> is only stateful while one or more users are connected to it. This can make it easy to have state that behaves more closely to a regular React <code>useState</code>, when desireable.</p>
<p>This component also features role verification, which allows you to choose the Teams meeting roles which are eligible to edit the state, if needed.</p>
<pre><code class="language-javascript"><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">useLiveState</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@microsoft/live-share-react&quot;</span><span class="hl-1">;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">UserMeetingRole</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@microsoft/live-share&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-7">ALLOWED_ROLES</span><span class="hl-1"> = [</span><span class="hl-5">UserMeetingRole</span><span class="hl-1">.</span><span class="hl-5">organizer</span><span class="hl-1">, </span><span class="hl-5">UserMeetingRole</span><span class="hl-1">.</span><span class="hl-5">presenter</span><span class="hl-1"> ];</span><br/><br/><span class="hl-4">export</span><span class="hl-1"> </span><span class="hl-3">function</span><span class="hl-1"> </span><span class="hl-0">AppState</span><span class="hl-1">() {</span><br/><span class="hl-1">  </span><span class="hl-3">const</span><span class="hl-1"> [</span><span class="hl-7">state</span><span class="hl-1">, </span><span class="hl-7">setState</span><span class="hl-1">] = </span><span class="hl-0">useLiveState</span><span class="hl-1">(</span><span class="hl-2">&quot;CUSTOM-STATE-ID&quot;</span><span class="hl-1">, </span><span class="hl-5">ExampleAppState</span><span class="hl-1">.</span><span class="hl-7">WAITING</span><span class="hl-1">, </span><span class="hl-7">ALLOWED_ROLES</span><span class="hl-1">);</span><br/><br/><span class="hl-1">  </span><span class="hl-4">if</span><span class="hl-1"> (</span><span class="hl-5">state</span><span class="hl-1"> === </span><span class="hl-5">ExampleAppState</span><span class="hl-1">.</span><span class="hl-7">WAITING</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">return</span><span class="hl-1"> (</span><br/><span class="hl-1">      </span><span class="hl-8">&lt;</span><span class="hl-9">div</span><span class="hl-8">&gt;</span><br/><span class="hl-1">        </span><span class="hl-8">&lt;</span><span class="hl-9">h2</span><span class="hl-8">&gt;</span><span class="hl-3">{</span><span class="hl-2">&quot;Waiting&quot;</span><span class="hl-3">}</span><span class="hl-8">&lt;/</span><span class="hl-9">h2</span><span class="hl-8">&gt;</span><br/><span class="hl-1">        </span><span class="hl-8">&lt;</span><span class="hl-9">button</span><br/><span class="hl-1">          </span><span class="hl-10">onClick</span><span class="hl-1">=</span><span class="hl-3">{</span><span class="hl-14">() </span><span class="hl-3">=&gt;</span><span class="hl-14"> {</span><br/><span class="hl-14">            </span><span class="hl-0">setState</span><span class="hl-14">(</span><span class="hl-5">ExampleAppState</span><span class="hl-14">.</span><span class="hl-7">START</span><span class="hl-14">, {</span><br/><span class="hl-14">              </span><span class="hl-5">startedBy:</span><span class="hl-14"> </span><span class="hl-2">&quot;First Last&quot;</span><span class="hl-14">,</span><br/><span class="hl-14">            });</span><br/><span class="hl-14">          }</span><span class="hl-3">}</span><br/><span class="hl-1">        </span><span class="hl-8">&gt;</span><br/><span class="hl-1">          </span><span class="hl-3">{</span><span class="hl-2">&quot;Start&quot;</span><span class="hl-3">}</span><br/><span class="hl-1">        </span><span class="hl-8">&lt;/</span><span class="hl-9">button</span><span class="hl-8">&gt;</span><br/><span class="hl-1">      </span><span class="hl-8">&lt;/</span><span class="hl-9">div</span><span class="hl-8">&gt;</span><br/><span class="hl-1">    );</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><span class="hl-4">return</span><span class="hl-1"> (</span><br/><span class="hl-1">    </span><span class="hl-8">&lt;</span><span class="hl-9">div</span><span class="hl-8">&gt;</span><br/><span class="hl-1">      </span><span class="hl-8">&lt;</span><span class="hl-9">h2</span><span class="hl-8">&gt;</span><span class="hl-3">{</span><span class="hl-2">`Started by: </span><span class="hl-3">${</span><span class="hl-5">data</span><span class="hl-1">!</span><span class="hl-14">.</span><span class="hl-5">startedBy</span><span class="hl-3">}</span><span class="hl-2">`</span><span class="hl-3">}</span><span class="hl-8">&lt;/</span><span class="hl-9">h2</span><span class="hl-8">&gt;</span><br/><span class="hl-1">      </span><span class="hl-8">&lt;</span><span class="hl-9">button</span><br/><span class="hl-1">        </span><span class="hl-10">onClick</span><span class="hl-1">=</span><span class="hl-3">{</span><span class="hl-14">() </span><span class="hl-3">=&gt;</span><span class="hl-14"> {</span><br/><span class="hl-14">          </span><span class="hl-0">setState</span><span class="hl-14">(</span><span class="hl-5">ExampleAppState</span><span class="hl-14">.</span><span class="hl-7">WAITING</span><span class="hl-14">, </span><span class="hl-3">undefined</span><span class="hl-14">);</span><br/><span class="hl-14">        }</span><span class="hl-3">}</span><br/><span class="hl-1">      </span><span class="hl-8">&gt;</span><br/><span class="hl-1">        </span><span class="hl-3">{</span><span class="hl-2">&quot;End&quot;</span><span class="hl-3">}</span><br/><span class="hl-1">      </span><span class="hl-8">&lt;/</span><span class="hl-9">button</span><span class="hl-8">&gt;</span><br/><span class="hl-1">    </span><span class="hl-8">&lt;/</span><span class="hl-9">div</span><span class="hl-8">&gt;</span><br/><span class="hl-1">  );</span><br/><span class="hl-1">};</span>
</code><button>Copy</button></pre>
<a id="md:useliveevent" class="tsd-anchor"></a><h3><a href="#md:useliveevent">useLiveEvent</a></h3><p>If you want to generic JSON between clients that is completely transient, then <code>useLiveEvent</code> is a great choice. A good example of that is a reactions feature similar to that in Microsoft Teams meetings, since people joining a meeting late don&#39;t need to see reactions from earlier in the meeting.</p>
<p>Here is a simple example:</p>
<pre><code class="language-javascript"><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">useLiveEvent</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@microsoft/live-share-react&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">export</span><span class="hl-1"> </span><span class="hl-3">function</span><span class="hl-1"> </span><span class="hl-0">Reactions</span><span class="hl-1">() {</span><br/><span class="hl-1">  </span><span class="hl-3">const</span><span class="hl-1"> { </span><span class="hl-7">latestEvent</span><span class="hl-1">, </span><span class="hl-7">sendEvent</span><span class="hl-1"> } = </span><span class="hl-0">useLiveEvent</span><span class="hl-1">(</span><span class="hl-2">&quot;EVENT-ID&quot;</span><span class="hl-1">);</span><br/><br/><span class="hl-1">  </span><span class="hl-4">return</span><span class="hl-1"> (</span><br/><span class="hl-1">    </span><span class="hl-8">&lt;</span><span class="hl-9">div</span><span class="hl-8">&gt;</span><br/><span class="hl-1">      </span><span class="hl-3">{</span><span class="hl-6">/* Buttons for sending reactions */</span><span class="hl-3">}</span><br/><span class="hl-1">      </span><span class="hl-8">&lt;</span><span class="hl-9">button</span><br/><span class="hl-1">        </span><span class="hl-10">onClick</span><span class="hl-1">=</span><span class="hl-3">{</span><span class="hl-14">() </span><span class="hl-3">=&gt;</span><span class="hl-14"> {</span><br/><span class="hl-14">          </span><span class="hl-0">sendEvent</span><span class="hl-14">({ </span><span class="hl-5">emoji:</span><span class="hl-14"> </span><span class="hl-2">&quot;‚ù§Ô∏è&quot;</span><span class="hl-14"> });</span><br/><span class="hl-14">        }</span><span class="hl-3">}</span><br/><span class="hl-1">      </span><span class="hl-8">&gt;</span><br/><span class="hl-1">        </span><span class="hl-3">{</span><span class="hl-2">&quot;‚ù§Ô∏è&quot;</span><span class="hl-3">}</span><br/><span class="hl-1">      </span><span class="hl-8">&lt;/</span><span class="hl-9">button</span><span class="hl-8">&gt;</span><br/><span class="hl-1">      </span><span class="hl-8">&lt;</span><span class="hl-9">button</span><br/><span class="hl-1">        </span><span class="hl-10">onClick</span><span class="hl-1">=</span><span class="hl-3">{</span><span class="hl-14">() </span><span class="hl-3">=&gt;</span><span class="hl-14"> {</span><br/><span class="hl-14">          </span><span class="hl-0">sendEvent</span><span class="hl-14">({ </span><span class="hl-5">emoji:</span><span class="hl-14"> </span><span class="hl-2">&quot;üòÇ&quot;</span><span class="hl-14"> });</span><br/><span class="hl-14">        }</span><span class="hl-3">}</span><br/><span class="hl-1">      </span><span class="hl-8">&gt;</span><br/><span class="hl-1">        </span><span class="hl-3">{</span><span class="hl-2">&quot;üòÇ&quot;</span><span class="hl-3">}</span><br/><span class="hl-1">      </span><span class="hl-8">&lt;/</span><span class="hl-9">button</span><span class="hl-8">&gt;</span><br/><span class="hl-1">      </span><span class="hl-3">{</span><span class="hl-6">/* Show latest reaction */</span><span class="hl-3">}</span><br/><span class="hl-1">      </span><span class="hl-3">{</span><span class="hl-5">latestEvent</span><span class="hl-14">?.</span><span class="hl-5">local</span><span class="hl-14"> </span><span class="hl-1">===</span><span class="hl-14"> </span><span class="hl-3">false</span><span class="hl-14"> </span><span class="hl-1">&amp;&amp;</span><span class="hl-14"> (</span><br/><span class="hl-14">        </span><span class="hl-8">&lt;</span><span class="hl-9">div</span><span class="hl-8">&gt;</span><span class="hl-3">{</span><span class="hl-2">`Received: </span><span class="hl-3">${</span><span class="hl-5">latestEvent</span><span class="hl-14">?.</span><span class="hl-5">value</span><span class="hl-14">.</span><span class="hl-5">emoji</span><span class="hl-3">}</span><span class="hl-2">`</span><span class="hl-3">}</span><span class="hl-8">&lt;/</span><span class="hl-9">div</span><span class="hl-8">&gt;</span><br/><span class="hl-14">      )</span><span class="hl-3">}</span><br/><span class="hl-1">      </span><span class="hl-3">{</span><span class="hl-5">latestEvent</span><span class="hl-14">?.</span><span class="hl-5">local</span><span class="hl-14"> </span><span class="hl-1">===</span><span class="hl-14"> </span><span class="hl-3">true</span><span class="hl-14"> </span><span class="hl-1">&amp;&amp;</span><span class="hl-14"> (</span><br/><span class="hl-14">        </span><span class="hl-8">&lt;</span><span class="hl-9">div</span><span class="hl-8">&gt;</span><span class="hl-3">{</span><span class="hl-2">`Sent: </span><span class="hl-3">${</span><span class="hl-5">latestEvent</span><span class="hl-14">?.</span><span class="hl-5">value</span><span class="hl-14">.</span><span class="hl-5">emoji</span><span class="hl-3">}</span><span class="hl-2">`</span><span class="hl-3">}</span><span class="hl-8">&lt;/</span><span class="hl-9">div</span><span class="hl-8">&gt;</span><br/><span class="hl-14">      )</span><span class="hl-3">}</span><br/><span class="hl-1">    </span><span class="hl-8">&lt;/</span><span class="hl-9">div</span><span class="hl-8">&gt;</span><br/><span class="hl-1">  );</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<a id="md:uselivetimer" class="tsd-anchor"></a><h3><a href="#md:uselivetimer">useLiveTimer</a></h3><p>You can use the <code>useLiveTimer</code> hook to build a synchronized countdown timer. A good example of that might be a meditation timer or a countdown for a round in a group activity.</p>
<p>Here is a simple example:</p>
<pre><code class="language-javascript"><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">useLiveTimer</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@microsoft/live-share-react&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">export</span><span class="hl-1"> </span><span class="hl-3">function</span><span class="hl-1"> </span><span class="hl-0">CountdownTimer</span><span class="hl-1">() {</span><br/><span class="hl-1">  </span><span class="hl-3">const</span><span class="hl-1"> { </span><span class="hl-7">milliRemaining</span><span class="hl-1">, </span><span class="hl-7">timerConfig</span><span class="hl-1">, </span><span class="hl-7">start</span><span class="hl-1">, </span><span class="hl-7">pause</span><span class="hl-1">, </span><span class="hl-7">play</span><span class="hl-1"> } = </span><span class="hl-0">useLiveTimer</span><span class="hl-1">(</span><span class="hl-2">&quot;TIMER-ID&quot;</span><span class="hl-1">);</span><br/><br/><span class="hl-1">  </span><span class="hl-4">return</span><span class="hl-1"> (</span><br/><span class="hl-1">    </span><span class="hl-8">&lt;</span><span class="hl-9">div</span><span class="hl-8">&gt;</span><br/><span class="hl-1">      </span><span class="hl-8">&lt;</span><span class="hl-9">button</span><br/><span class="hl-1">        </span><span class="hl-10">onClick</span><span class="hl-1">=</span><span class="hl-3">{</span><span class="hl-14">() </span><span class="hl-3">=&gt;</span><span class="hl-14"> {</span><br/><span class="hl-14">          </span><span class="hl-0">start</span><span class="hl-14">(</span><span class="hl-13">60</span><span class="hl-14"> </span><span class="hl-1">*</span><span class="hl-14"> </span><span class="hl-13">1000</span><span class="hl-14">);</span><br/><span class="hl-14">        }</span><span class="hl-3">}</span><br/><span class="hl-1">      </span><span class="hl-8">&gt;</span><br/><span class="hl-1">        </span><span class="hl-3">{</span><span class="hl-14"> </span><span class="hl-5">timerConfig</span><span class="hl-14"> </span><span class="hl-1">===</span><span class="hl-14"> </span><span class="hl-3">undefined</span><span class="hl-14"> </span><span class="hl-1">?</span><span class="hl-14"> </span><span class="hl-2">&quot;Start&quot;</span><span class="hl-14"> </span><span class="hl-1">:</span><span class="hl-14"> </span><span class="hl-2">&quot;Reset&quot;</span><span class="hl-14"> </span><span class="hl-3">}</span><br/><span class="hl-1">      </span><span class="hl-8">&lt;/</span><span class="hl-9">button</span><span class="hl-8">&gt;</span><br/><span class="hl-1">      </span><span class="hl-3">{</span><span class="hl-14"> </span><span class="hl-5">timerConfig</span><span class="hl-14"> </span><span class="hl-1">!==</span><span class="hl-14"> </span><span class="hl-3">undefined</span><span class="hl-14"> </span><span class="hl-1">&amp;&amp;</span><span class="hl-14"> (</span><br/><span class="hl-14">        </span><span class="hl-8">&lt;</span><span class="hl-9">button</span><br/><span class="hl-14">          </span><span class="hl-10">onClick</span><span class="hl-1">=</span><span class="hl-3">{</span><span class="hl-14">() </span><span class="hl-3">=&gt;</span><span class="hl-14"> {</span><br/><span class="hl-14">            </span><span class="hl-4">if</span><span class="hl-14"> (</span><span class="hl-5">timerConfig</span><span class="hl-14">.</span><span class="hl-5">running</span><span class="hl-14">) {</span><br/><span class="hl-14">              </span><span class="hl-0">pause</span><span class="hl-14">();</span><br/><span class="hl-14">            } </span><span class="hl-4">else</span><span class="hl-14"> {</span><br/><span class="hl-14">              </span><span class="hl-0">play</span><span class="hl-14">();</span><br/><span class="hl-14">            }</span><br/><span class="hl-14">          }</span><span class="hl-3">}</span><br/><span class="hl-14">        </span><span class="hl-8">&gt;</span><br/><span class="hl-14">          </span><span class="hl-3">{</span><span class="hl-5">timerConfig</span><span class="hl-14">.</span><span class="hl-5">running</span><span class="hl-14"> </span><span class="hl-1">?</span><span class="hl-14"> </span><span class="hl-2">&quot;Pause&quot;</span><span class="hl-14"> </span><span class="hl-1">:</span><span class="hl-14"> </span><span class="hl-2">&quot;Play&quot;</span><span class="hl-14"> </span><span class="hl-3">}</span><br/><span class="hl-14">        </span><span class="hl-8">&lt;/</span><span class="hl-9">button</span><span class="hl-8">&gt;</span><br/><span class="hl-14">      )</span><span class="hl-3">}</span><br/><span class="hl-1">      </span><span class="hl-3">{</span><span class="hl-14"> </span><span class="hl-5">milliRemaining</span><span class="hl-14"> </span><span class="hl-1">!==</span><span class="hl-14"> </span><span class="hl-3">undefined</span><span class="hl-14"> </span><span class="hl-1">&amp;&amp;</span><span class="hl-14"> (</span><br/><span class="hl-14">        </span><span class="hl-8">&lt;</span><span class="hl-9">p</span><span class="hl-8">&gt;</span><br/><span class="hl-14">          </span><span class="hl-3">{</span><span class="hl-14"> </span><span class="hl-2">`</span><span class="hl-3">${</span><span class="hl-5">Math</span><span class="hl-14">.</span><span class="hl-0">round</span><span class="hl-14">(</span><span class="hl-5">milliRemaining</span><span class="hl-14"> </span><span class="hl-1">/</span><span class="hl-14"> </span><span class="hl-13">1000</span><span class="hl-14">)</span><span class="hl-3">}</span><span class="hl-2"> / </span><span class="hl-3">${</span><span class="hl-5">Math</span><span class="hl-14">.</span><span class="hl-0">round</span><span class="hl-14">(</span><span class="hl-5">timerConfig</span><span class="hl-14">.</span><span class="hl-5">duration</span><span class="hl-14">) </span><span class="hl-1">/</span><span class="hl-14"> </span><span class="hl-13">1000</span><span class="hl-3">}</span><span class="hl-2">`</span><span class="hl-14"> </span><span class="hl-3">}</span><br/><span class="hl-14">        </span><span class="hl-8">&lt;/</span><span class="hl-9">p</span><span class="hl-8">&gt;</span><br/><span class="hl-14">      )</span><span class="hl-3">}</span><br/><span class="hl-1">    </span><span class="hl-8">&lt;/</span><span class="hl-9">div</span><span class="hl-8">&gt;</span><br/><span class="hl-1">  );</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<a id="md:usemediasynchronizer" class="tsd-anchor"></a><h3><a href="#md:usemediasynchronizer">useMediaSynchronizer</a></h3><p>If you want to synchronize video content, <code>@microsoft/live-share-media</code> is also supported by this package through the <code>useMediaSynchronizer</code> hook. Using any <code>HTMLMediaPlayer</code> element, or a delegate object matching our <code>IMediaPlayer</code> interface, you can easily build watch together capabilities into your app.</p>
<p>Let&#39;s see this in action:</p>
<pre><code class="language-javascript"><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">useMediaSynchronizer</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@microsoft/live-share-react&quot;</span><span class="hl-1">;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">UserMeetingRole</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@microsoft/live-share&quot;</span><span class="hl-1">;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">useRef</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&quot;react&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-7">ALLOWED_ROLES</span><span class="hl-1"> = [</span><span class="hl-5">UserMeetingRole</span><span class="hl-1">.</span><span class="hl-5">organizer</span><span class="hl-1">, </span><span class="hl-5">UserMeetingRole</span><span class="hl-1">.</span><span class="hl-5">presenter</span><span class="hl-1">];</span><br/><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-7">INITIAL_TRACK</span><span class="hl-1"> =</span><br/><span class="hl-1">  </span><span class="hl-2">&quot;https://storage.googleapis.com/media-session/big-buck-bunny/trailer.mov&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">export</span><span class="hl-1"> </span><span class="hl-3">function</span><span class="hl-1"> </span><span class="hl-0">VideoPlayer</span><span class="hl-1">() {</span><br/><span class="hl-1">  </span><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-7">videoRef</span><span class="hl-1"> = </span><span class="hl-0">useRef</span><span class="hl-1">(</span><span class="hl-3">null</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-3">const</span><span class="hl-1"> { </span><span class="hl-7">play</span><span class="hl-1">, </span><span class="hl-7">pause</span><span class="hl-1"> } = </span><span class="hl-0">useMediaSynchronizer</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;MEDIA-SESSION-ID&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">videoRef</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-7">INITIAL_TRACK</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-7">ALLOWED_ROLES</span><br/><span class="hl-1">  );</span><br/><br/><span class="hl-1">  </span><span class="hl-4">return</span><span class="hl-1"> (</span><br/><span class="hl-1">    </span><span class="hl-8">&lt;</span><span class="hl-9">div</span><span class="hl-8">&gt;</span><br/><span class="hl-1">      </span><span class="hl-8">&lt;</span><span class="hl-9">video</span><span class="hl-1"> </span><span class="hl-10">ref</span><span class="hl-1">=</span><span class="hl-3">{</span><span class="hl-5">videoRef</span><span class="hl-3">}</span><span class="hl-1"> </span><span class="hl-8">/&gt;</span><br/><span class="hl-1">      </span><span class="hl-8">&lt;</span><span class="hl-9">button</span><span class="hl-1"> </span><span class="hl-10">onClick</span><span class="hl-1">=</span><span class="hl-3">{</span><span class="hl-5">play</span><span class="hl-3">}</span><span class="hl-8">&gt;</span><span class="hl-3">{</span><span class="hl-2">&quot;Play&quot;</span><span class="hl-3">}</span><span class="hl-8">&lt;/</span><span class="hl-9">button</span><span class="hl-8">&gt;</span><br/><span class="hl-1">      </span><span class="hl-8">&lt;</span><span class="hl-9">button</span><span class="hl-1"> </span><span class="hl-10">onClick</span><span class="hl-1">=</span><span class="hl-3">{</span><span class="hl-5">pause</span><span class="hl-3">}</span><span class="hl-8">&gt;</span><span class="hl-3">{</span><span class="hl-2">&quot;Pause&quot;</span><span class="hl-3">}</span><span class="hl-8">&lt;/</span><span class="hl-9">button</span><span class="hl-8">&gt;</span><br/><span class="hl-1">    </span><span class="hl-8">&lt;/</span><span class="hl-9">div</span><span class="hl-8">&gt;</span><br/><span class="hl-1">  );</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<a id="md:uselivecanvas" class="tsd-anchor"></a><h3><a href="#md:uselivecanvas">useLiveCanvas</a></h3><p>If you want to add turn-key inking &amp; cursors, use the <code>useLiveCanvas</code> hook, powered by <code>@microsoft/live-share-canvas</code>.</p>
<p>Let&#39;s see this in action:</p>
<pre><code class="language-javascript"><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">useLiveCanvas</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@microsoft/live-share-react&quot;</span><span class="hl-1">;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">InkingTool</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@microsoft/live-share-canvas&quot;</span><span class="hl-1">;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">useRef</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&quot;react&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">export</span><span class="hl-1"> </span><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-0">ExampleLiveCanvas</span><span class="hl-1"> = () </span><span class="hl-3">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-7">liveCanvasRef</span><span class="hl-1"> = </span><span class="hl-0">useRef</span><span class="hl-1">(</span><span class="hl-3">null</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-3">const</span><span class="hl-1"> { </span><span class="hl-7">liveCanvas</span><span class="hl-1">, </span><span class="hl-7">inkingManager</span><span class="hl-1"> } = </span><span class="hl-0">useLiveCanvas</span><span class="hl-1">(</span><br/><span class="hl-1">        </span><span class="hl-2">&quot;CUSTOM-LIVE-CANVAS&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-5">liveCanvasRef</span><span class="hl-1">,</span><br/><span class="hl-1">    );</span><br/><br/><span class="hl-1">    </span><span class="hl-4">return</span><span class="hl-1"> (</span><br/><span class="hl-1">        {</span><span class="hl-6">/** Canvas currently needs to be a child of a parent with absolute styling */</span><span class="hl-1">}</span><br/><span class="hl-1">        </span><span class="hl-8">&lt;</span><span class="hl-9">div</span><span class="hl-1"> </span><span class="hl-10">style</span><span class="hl-1">=</span><span class="hl-3">{</span><span class="hl-14">{ </span><span class="hl-5">position:</span><span class="hl-14"> </span><span class="hl-2">&quot;absolute&quot;</span><span class="hl-14">}</span><span class="hl-3">}</span><span class="hl-8">&gt;</span><br/><span class="hl-1">            </span><span class="hl-8">&lt;</span><span class="hl-9">div</span><br/><span class="hl-1">                </span><span class="hl-10">ref</span><span class="hl-1">=</span><span class="hl-3">{</span><span class="hl-5">liveCanvasRef</span><span class="hl-3">}</span><br/><span class="hl-1">                </span><span class="hl-6">// Best practice is to not define inline styles</span><br/><span class="hl-1">                </span><span class="hl-10">style</span><span class="hl-1">=</span><span class="hl-3">{</span><span class="hl-14">{ </span><span class="hl-5">width:</span><span class="hl-14"> </span><span class="hl-2">&quot;556px&quot;</span><span class="hl-14">, </span><span class="hl-5">height:</span><span class="hl-14"> </span><span class="hl-2">&quot;224px&quot;</span><span class="hl-14"> }</span><span class="hl-3">}</span><br/><span class="hl-1">            </span><span class="hl-8">/&gt;</span><br/><span class="hl-1">            </span><span class="hl-3">{</span><span class="hl-1">!!</span><span class="hl-5">liveCanvas</span><span class="hl-14"> </span><span class="hl-1">&amp;&amp;</span><span class="hl-14"> (</span><br/><span class="hl-14">                </span><span class="hl-8">&lt;</span><span class="hl-9">div</span><span class="hl-8">&gt;</span><br/><span class="hl-14">                    </span><span class="hl-8">&lt;</span><span class="hl-9">button</span><br/><span class="hl-14">                        </span><span class="hl-10">onClick</span><span class="hl-1">=</span><span class="hl-3">{</span><span class="hl-14">() </span><span class="hl-3">=&gt;</span><span class="hl-14"> {</span><br/><span class="hl-14">                            </span><span class="hl-5">inkingManager</span><span class="hl-14">.</span><span class="hl-5">tool</span><span class="hl-14"> </span><span class="hl-1">=</span><span class="hl-14"> </span><span class="hl-5">InkingTool</span><span class="hl-14">.</span><span class="hl-5">pen</span><span class="hl-14">;</span><br/><span class="hl-14">                        }</span><span class="hl-3">}</span><br/><span class="hl-14">                    </span><span class="hl-8">&gt;</span><br/><span class="hl-14">                        </span><span class="hl-3">{</span><span class="hl-2">&quot;Pen&quot;</span><span class="hl-3">}</span><br/><span class="hl-14">                    </span><span class="hl-8">&lt;/</span><span class="hl-9">button</span><span class="hl-8">&gt;</span><br/><span class="hl-14">                    </span><span class="hl-8">&lt;</span><span class="hl-9">button</span><br/><span class="hl-14">                        </span><span class="hl-10">onClick</span><span class="hl-1">=</span><span class="hl-3">{</span><span class="hl-14">() </span><span class="hl-3">=&gt;</span><span class="hl-14"> {</span><br/><span class="hl-14">                            </span><span class="hl-5">inkingManager</span><span class="hl-14">.</span><span class="hl-5">tool</span><span class="hl-14"> </span><span class="hl-1">=</span><span class="hl-14"> </span><span class="hl-5">InkingTool</span><span class="hl-14">.</span><span class="hl-5">laserPointer</span><span class="hl-14">;</span><br/><span class="hl-14">                        }</span><span class="hl-3">}</span><br/><span class="hl-14">                    </span><span class="hl-8">&gt;</span><br/><span class="hl-14">                        </span><span class="hl-3">{</span><span class="hl-2">&quot;Laser pointer&quot;</span><span class="hl-3">}</span><br/><span class="hl-14">                    </span><span class="hl-8">&lt;/</span><span class="hl-9">button</span><span class="hl-8">&gt;</span><br/><span class="hl-14">                </span><span class="hl-8">&lt;/</span><span class="hl-9">div</span><span class="hl-8">&gt;</span><br/><span class="hl-14">            )</span><span class="hl-3">}</span><br/><span class="hl-1">        </span><span class="hl-8">&lt;/</span><span class="hl-9">div</span><span class="hl-8">&gt;</span><br/><span class="hl-1">    );</span><br/><span class="hl-1">};</span>
</code><button>Copy</button></pre>
<a id="md:usetaskmanager" class="tsd-anchor"></a><h3><a href="#md:usetaskmanager">useTaskManager</a></h3><p>If you want to ensure that only one user is responsible for a given task, you can use <code>useTaskManager</code>, which uses Fluid&#39;s <code>TaskManager</code> DDS.</p>
<p>Let&#39;s see this in action:</p>
<pre><code class="language-javascript"><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">useTaskManager</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@microsoft/live-share-react&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">export</span><span class="hl-1"> </span><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-0">ExampleTaskManager</span><span class="hl-1"> = () </span><span class="hl-3">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">const</span><span class="hl-1"> [</span><span class="hl-7">taskId</span><span class="hl-1">, </span><span class="hl-7">setTaskId</span><span class="hl-1">] = </span><span class="hl-0">useState</span><span class="hl-1">(</span><span class="hl-3">undefined</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-3">const</span><span class="hl-1"> { </span><span class="hl-7">lockedTask</span><span class="hl-1"> } = </span><span class="hl-0">useTaskManager</span><span class="hl-1">(</span><br/><span class="hl-1">        </span><span class="hl-2">&quot;CUSTOM-TASK-MANAGER&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-5">taskId</span><span class="hl-1">,</span><br/><span class="hl-1">    );</span><br/><br/><span class="hl-1">    </span><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-7">displayText</span><span class="hl-1"> = </span><span class="hl-5">lockedTask</span><br/><span class="hl-1">        ? </span><span class="hl-2">&quot;You are assigned the task&quot;</span><br/><span class="hl-1">        : </span><span class="hl-2">&quot;Waiting for task assignment&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-1">    </span><span class="hl-4">return</span><span class="hl-1"> (</span><br/><span class="hl-1">        </span><span class="hl-8">&lt;</span><span class="hl-9">div</span><span class="hl-8">&gt;</span><br/><span class="hl-1">            </span><span class="hl-3">{</span><span class="hl-1">!</span><span class="hl-5">taskId</span><span class="hl-14"> </span><span class="hl-1">&amp;&amp;</span><span class="hl-14"> (</span><br/><span class="hl-14">                </span><span class="hl-8">&lt;</span><span class="hl-9">button</span><br/><span class="hl-14">                    </span><span class="hl-10">onClick</span><span class="hl-1">=</span><span class="hl-3">{</span><span class="hl-14">() </span><span class="hl-3">=&gt;</span><span class="hl-14"> {</span><br/><span class="hl-14">                        </span><span class="hl-0">setTaskId</span><span class="hl-14">(</span><span class="hl-2">&quot;task-id&quot;</span><span class="hl-14">)</span><br/><span class="hl-14">                    }</span><span class="hl-3">}</span><br/><span class="hl-14">                </span><span class="hl-8">&gt;</span><br/><span class="hl-14">                    </span><span class="hl-3">{</span><span class="hl-2">&#39;Join task queue&#39;</span><span class="hl-3">}</span><br/><span class="hl-14">                </span><span class="hl-8">&lt;/</span><span class="hl-9">button</span><span class="hl-8">&gt;</span><br/><span class="hl-14">            )</span><span class="hl-3">}</span><br/><span class="hl-1">            </span><span class="hl-3">{</span><span class="hl-5">taskId</span><span class="hl-14"> </span><span class="hl-1">&amp;&amp;</span><span class="hl-14"> (</span><br/><span class="hl-14">                </span><span class="hl-8">&lt;</span><span class="hl-9">button</span><br/><span class="hl-14">                    </span><span class="hl-10">onClick</span><span class="hl-1">=</span><span class="hl-3">{</span><span class="hl-14">() </span><span class="hl-3">=&gt;</span><span class="hl-14"> {</span><br/><span class="hl-14">                        </span><span class="hl-0">setTaskId</span><span class="hl-14">(</span><span class="hl-3">undefined</span><span class="hl-14">)</span><br/><span class="hl-14">                    }</span><span class="hl-3">}</span><br/><span class="hl-14">                </span><span class="hl-8">&gt;</span><br/><span class="hl-14">                    </span><span class="hl-3">{</span><span class="hl-2">&#39;Leave task queue&#39;</span><span class="hl-3">}</span><br/><span class="hl-14">                </span><span class="hl-8">&lt;/</span><span class="hl-9">button</span><span class="hl-8">&gt;</span><br/><span class="hl-14">            )</span><span class="hl-3">}</span><br/><span class="hl-1">            </span><span class="hl-8">&lt;</span><span class="hl-9">p</span><span class="hl-8">&gt;</span><span class="hl-3">{</span><span class="hl-5">displayText</span><span class="hl-3">}</span><span class="hl-8">&lt;/</span><span class="hl-9">p</span><span class="hl-8">&gt;</span><br/><span class="hl-1">        </span><span class="hl-8">&lt;/</span><span class="hl-9">div</span><span class="hl-8">&gt;</span><br/><span class="hl-1">    );</span><br/><span class="hl-1">};</span>
</code><button>Copy</button></pre>
<a id="md:custom-fluid-object-hooks" class="tsd-anchor"></a><h3><a href="#md:custom-fluid-object-hooks">Custom Fluid object hooks</a></h3><p>If you want to dynamically load a custom Fluid object in your app, use the <code>useDynamicDDS</code> to create a custom hook. This is the same hook that Live Share React uses internally within our custom hooks, such as <code>useLiveEvent</code>. If you made a custom data object or are using one of Fluid&#39;s experimental data structures, you also must register your Fluid <code>LoadableObjectClass</code> with <code>DynamicObjectRegistry.registerObjectClass</code> to <code>@microsoft/live-share</code>, if it is not already.</p>
<p>Implementations may vary for each dynamic object &amp; hook. We will try and update this package periodically with new packages released by Fluid Framework and Live Share, as they are published.</p>
<p>Example:</p>
<pre><code class="language-typescript"><span class="hl-4">import</span><span class="hl-1"> </span><span class="hl-5">React</span><span class="hl-1"> </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&quot;react&quot;</span><span class="hl-1">;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">useDynamicDDS</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@microsoft/live-share-react&quot;</span><span class="hl-1">;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">DynamicObjectRegistry</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@microsoft/live-share&quot;</span><span class="hl-1">;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">TaskManager</span><span class="hl-1">  } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@fluid-experimental/task-manager&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-6">// Register TaskManager as dynamic object</span><br/><span class="hl-5">DynamicObjectRegistry</span><span class="hl-1">.</span><span class="hl-0">registerObjectClass</span><span class="hl-1">(</span><span class="hl-5">TaskManager</span><span class="hl-1">, </span><span class="hl-5">TaskManager</span><span class="hl-1">.</span><span class="hl-0">getFactory</span><span class="hl-1">().</span><span class="hl-5">type</span><span class="hl-1">);</span><br/><br/><span class="hl-6">/**</span><br/><span class="hl-6"> * A hook for joining a queue to lock tasks for a given id. Guaranteed to have only one user assigned to a task at a time.</span><br/><span class="hl-6"> * </span><br/><span class="hl-6"> * </span><span class="hl-3">@param</span><span class="hl-6"> </span><span class="hl-5">uniqueKey</span><span class="hl-6"> the unique key for the TaskManager DDS</span><br/><span class="hl-6"> * </span><span class="hl-3">@param</span><span class="hl-6"> </span><span class="hl-5">taskId</span><span class="hl-6"> the task id to lock</span><br/><span class="hl-6"> * </span><span class="hl-3">@returns</span><span class="hl-6"> stateful data about the status of the task lock</span><br/><span class="hl-6"> */</span><br/><span class="hl-4">export</span><span class="hl-1"> </span><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-0">useTaskManager</span><span class="hl-1"> = (</span><span class="hl-5">uniqueKey</span><span class="hl-1">: </span><span class="hl-12">string</span><span class="hl-1">, </span><span class="hl-5">taskId</span><span class="hl-1">?: </span><span class="hl-12">string</span><span class="hl-1">): {</span><br/><span class="hl-1">    </span><span class="hl-5">lockedTask</span><span class="hl-1">: </span><span class="hl-12">boolean</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-5">taskManager</span><span class="hl-1">: </span><span class="hl-12">TaskManager</span><span class="hl-1"> | </span><span class="hl-12">undefined</span><span class="hl-1">;</span><br/><span class="hl-1">} </span><span class="hl-3">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">/**</span><br/><span class="hl-6">     * TaskId currently in queue for</span><br/><span class="hl-6">     */</span><br/><span class="hl-1">    </span><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-7">currentTaskIdRef</span><span class="hl-1"> = </span><span class="hl-5">React</span><span class="hl-1">.</span><span class="hl-0">useRef</span><span class="hl-1">&lt;</span><span class="hl-12">string</span><span class="hl-1"> | </span><span class="hl-12">undefined</span><span class="hl-1">&gt;(</span><span class="hl-3">undefined</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-6">/**</span><br/><span class="hl-6">     * Stateful boolean that is true when the user is currently assigned the task</span><br/><span class="hl-6">     */</span><br/><span class="hl-1">    </span><span class="hl-3">const</span><span class="hl-1"> [</span><span class="hl-7">lockedTask</span><span class="hl-1">, </span><span class="hl-7">setLockedTask</span><span class="hl-1">] = </span><span class="hl-5">React</span><span class="hl-1">.</span><span class="hl-0">useState</span><span class="hl-1">&lt;</span><span class="hl-12">boolean</span><span class="hl-1">&gt;(</span><span class="hl-3">false</span><span class="hl-1">);</span><br/><br/><span class="hl-1">    </span><span class="hl-6">/**</span><br/><span class="hl-6">     * User facing: dynamically load the TaskManager DDS for the given unique key.</span><br/><span class="hl-6">     */</span><br/><span class="hl-1">    </span><span class="hl-3">const</span><span class="hl-1"> { </span><span class="hl-5">dds</span><span class="hl-1">: </span><span class="hl-7">taskManager</span><span class="hl-1"> } = </span><span class="hl-0">useDynamicDDS</span><span class="hl-1">&lt;</span><span class="hl-12">TaskManager</span><span class="hl-1">&gt;(</span><span class="hl-5">uniqueKey</span><span class="hl-1">, </span><span class="hl-5">TaskManager</span><span class="hl-1">);</span><br/><br/><span class="hl-1">    </span><span class="hl-6">/**</span><br/><span class="hl-6">     * When the task id changes, lock the task. When the task id is undefined, abandon the task.</span><br/><span class="hl-6">     */</span><br/><span class="hl-1">    </span><span class="hl-5">React</span><span class="hl-1">.</span><span class="hl-0">useEffect</span><span class="hl-1">(() </span><span class="hl-3">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-3">let</span><span class="hl-1"> </span><span class="hl-5">mounted</span><span class="hl-1"> = </span><span class="hl-3">true</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-4">if</span><span class="hl-1"> (</span><span class="hl-5">taskManager</span><span class="hl-1">) {</span><br/><span class="hl-1">            </span><span class="hl-4">if</span><span class="hl-1"> (</span><span class="hl-5">taskId</span><span class="hl-1"> &amp;&amp; </span><span class="hl-5">currentTaskIdRef</span><span class="hl-1">.</span><span class="hl-5">current</span><span class="hl-1"> !== </span><span class="hl-5">taskId</span><span class="hl-1">) {</span><br/><span class="hl-1">                </span><span class="hl-4">if</span><span class="hl-1"> (</span><span class="hl-5">currentTaskIdRef</span><span class="hl-1">.</span><span class="hl-5">current</span><span class="hl-1">) {</span><br/><span class="hl-1">                    </span><span class="hl-5">taskManager</span><span class="hl-1">.</span><span class="hl-0">abandon</span><span class="hl-1">(</span><span class="hl-5">currentTaskIdRef</span><span class="hl-1">.</span><span class="hl-5">current</span><span class="hl-1">);</span><br/><span class="hl-1">                    </span><span class="hl-0">setLockedTask</span><span class="hl-1">(</span><span class="hl-3">false</span><span class="hl-1">);</span><br/><span class="hl-1">                }</span><br/><span class="hl-1">                </span><span class="hl-5">currentTaskIdRef</span><span class="hl-1">.</span><span class="hl-5">current</span><span class="hl-1"> = </span><span class="hl-5">taskId</span><span class="hl-1">;</span><br/><span class="hl-1">                </span><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-0">onLockTask</span><span class="hl-1"> = </span><span class="hl-3">async</span><span class="hl-1"> () </span><span class="hl-3">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">                    </span><span class="hl-4">try</span><span class="hl-1"> {</span><br/><span class="hl-1">                        </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">taskManager</span><span class="hl-1">.</span><span class="hl-0">lockTask</span><span class="hl-1">(</span><span class="hl-5">taskId</span><span class="hl-1">);</span><br/><span class="hl-1">                        </span><span class="hl-4">if</span><span class="hl-1"> (</span><span class="hl-5">mounted</span><span class="hl-1">) {</span><br/><span class="hl-1">                            </span><span class="hl-0">setLockedTask</span><span class="hl-1">(</span><span class="hl-3">true</span><span class="hl-1">);</span><br/><span class="hl-1">                        }</span><br/><span class="hl-1">                    } </span><span class="hl-4">catch</span><span class="hl-1"> {</span><br/><span class="hl-1">                        </span><span class="hl-4">if</span><span class="hl-1"> (</span><span class="hl-5">mounted</span><span class="hl-1">) {</span><br/><span class="hl-1">                            </span><span class="hl-0">setLockedTask</span><span class="hl-1">(</span><span class="hl-3">false</span><span class="hl-1">);</span><br/><span class="hl-1">                            </span><span class="hl-5">currentTaskIdRef</span><span class="hl-1">.</span><span class="hl-5">current</span><span class="hl-1"> = </span><span class="hl-3">undefined</span><span class="hl-1">;</span><br/><span class="hl-1">                        }</span><br/><span class="hl-1">                    }</span><br/><span class="hl-1">                }</span><br/><span class="hl-1">                </span><span class="hl-0">onLockTask</span><span class="hl-1">();</span><br/><span class="hl-1">            } </span><span class="hl-4">else</span><span class="hl-1"> </span><span class="hl-4">if</span><span class="hl-1"> (!</span><span class="hl-5">taskId</span><span class="hl-1"> &amp;&amp; </span><span class="hl-5">currentTaskIdRef</span><span class="hl-1">.</span><span class="hl-5">current</span><span class="hl-1">) {</span><br/><span class="hl-1">                </span><span class="hl-5">taskManager</span><span class="hl-1">.</span><span class="hl-0">abandon</span><span class="hl-1">(</span><span class="hl-5">currentTaskIdRef</span><span class="hl-1">.</span><span class="hl-5">current</span><span class="hl-1">);</span><br/><span class="hl-1">                </span><span class="hl-0">setLockedTask</span><span class="hl-1">(</span><span class="hl-3">false</span><span class="hl-1">);</span><br/><span class="hl-1">                </span><span class="hl-5">currentTaskIdRef</span><span class="hl-1">.</span><span class="hl-5">current</span><span class="hl-1"> = </span><span class="hl-3">undefined</span><span class="hl-1">;</span><br/><span class="hl-1">            }</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">        </span><span class="hl-6">/**</span><br/><span class="hl-6">         * When the component unmounts, abandon the task if it is still locked</span><br/><span class="hl-6">         */</span><br/><span class="hl-1">        </span><span class="hl-4">return</span><span class="hl-1"> () </span><span class="hl-3">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-5">mounted</span><span class="hl-1"> = </span><span class="hl-3">false</span><span class="hl-1">;</span><br/><span class="hl-1">            </span><span class="hl-4">if</span><span class="hl-1"> (</span><span class="hl-5">currentTaskIdRef</span><span class="hl-1">.</span><span class="hl-5">current</span><span class="hl-1">) {</span><br/><span class="hl-1">                </span><span class="hl-5">taskManager</span><span class="hl-1">?.</span><span class="hl-0">abandon</span><span class="hl-1">(</span><span class="hl-5">currentTaskIdRef</span><span class="hl-1">.</span><span class="hl-5">current</span><span class="hl-1">);</span><br/><span class="hl-1">            }</span><br/><span class="hl-1">            </span><span class="hl-5">currentTaskIdRef</span><span class="hl-1">.</span><span class="hl-5">current</span><span class="hl-1"> = </span><span class="hl-3">undefined</span><span class="hl-1">;</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">    }, [</span><span class="hl-5">taskManager</span><span class="hl-1">, </span><span class="hl-5">taskId</span><span class="hl-1">]);</span><br/><br/><span class="hl-1">    </span><span class="hl-4">return</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-5">lockedTask</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-5">taskManager</span><span class="hl-1">,</span><br/><span class="hl-1">    };</span><br/><span class="hl-1">};</span>
</code><button>Copy</button></pre>
<a id="md:code-samples" class="tsd-anchor"></a><h2><a href="#md:code-samples">Code samples</a></h2><table>
<thead>
<tr>
<th>Sample name</th>
<th>Description</th>
<th>Javascript</th>
</tr>
</thead>
<tbody><tr>
<td>Live Share React</td>
<td>Simple example with each of our custom Live Share React hooks.</td>
<td><a href="../../samples/javascript/04.live-share-react">View</a></td>
</tr>
</tbody></table>
<a id="md:react-version-compatibility" class="tsd-anchor"></a><h2><a href="#md:react-version-compatibility">React version compatibility</a></h2><p>This package is compatible with React versions <code>^16.8.0</code> and greater, including React v18. In order to ensure compatibility with different versions React, this project does not currently use React Suspense for data fetching on load. We are closely monitoring React guidelines and may post updates as this evolves further. If you have feedback or thoughts on this topic, join the <a href="https://github.com/microsoft/live-share-sdk/discussions/442">discussion</a>.</p>
<a id="md:package-compatibility" class="tsd-anchor"></a><h2><a href="#md:package-compatibility">Package Compatibility</a></h2><p>The Live Share SDK contains dependencies for <a href="https://www.npmjs.com/package/@microsoft/teams-js">@microsoft/teams-js</a> and <a href="https://www.npmjs.com/package/fluid-framework">fluid-framework</a> packages among others. Both of these packages are sensitive to the package version your app any libraries use. You will likely run into issues if the package version your app uses doesn&#39;t match the version other libraries you depend on use.</p>
<p><strong>It is critical that your app use the package dependencies listed in the table below.</strong> Lookup the version of the <code>@microsoft/live-share</code> you&#39;re using and set any other dependencies in your package.json file to match:</p>
<table>
<thead>
<tr>
<th>@microsoft/live-share</th>
<th>@microsoft/teams-js</th>
<th>fluid-framework</th>
<th>@microsoft/live-share-*</th>
<th>@fluidframework/azure-client</th>
<th>@microsoft/TeamsFx</th>
<th>@microsoft/TeamsFx-react</th>
</tr>
</thead>
<tbody><tr>
<td>1.0.0-preview.23</td>
<td>^2.11.0</td>
<td>^1.2.3</td>
<td>1.0.0-preview.23 (optional)</td>
<td>^1.0.0 (optional)</td>
<td>^2.5.0 (optional)</td>
<td>^2.5.0 (optional)</td>
</tr>
<tr>
<td>1.0.0-preview.10</td>
<td>^2.10.1</td>
<td>~1.2.3</td>
<td>1.0.0-preview.10 (optional)</td>
<td>~1.0.2 (optional)</td>
<td>^2.5.0 (optional)</td>
<td>^2.5.0 (optional)</td>
</tr>
<tr>
<td>1.0.0-preview.8</td>
<td>^2.5.0</td>
<td>~1.2.3</td>
<td>1.0.0-preview.10 (optional)</td>
<td>~1.0.2 (optional)</td>
<td>^2.5.0 (optional)</td>
<td>^2.5.0 (optional)</td>
</tr>
<tr>
<td>1.0.0-preview.3</td>
<td>2.0.0-experimental.1</td>
<td>~1.2.3</td>
<td>1.0.0-preview.3 (optional)</td>
<td>~1.0.2 (optional)</td>
<td>2.0.0-experimental.0 (optional)</td>
<td>2.0.0-experimental.0 (optional)</td>
</tr>
<tr>
<td>~0.5.1</td>
<td>2.0.0-experimental.1</td>
<td>~1.2.3</td>
<td>~0.5.1 (optional)</td>
<td>~1.0.2 (optional)</td>
<td>2.0.0-experimental.0 (optional)</td>
<td>2.0.0-experimental.0 (optional)</td>
</tr>
<tr>
<td>~0.3.1</td>
<td>2.0.0-experimental.0</td>
<td>~0.59.0</td>
<td>~0.3.1 (optional)</td>
<td>~0.59.0 (optional)</td>
<td>2.0.0-experimental.0 (optional)</td>
<td>2.0.0-experimental.0 (optional)</td>
</tr>
</tbody></table>
<a id="md:contributing" class="tsd-anchor"></a><h2><a href="#md:contributing">Contributing</a></h2><p>There are several ways you can <a href="../../CONTRIBUTING.md">contribute</a> to this project:</p>
<ul>
<li><a href="https://github.com/microsoft/live-share-sdk/issues">Submit bugs</a> and help us verify fixes as they are checked in.</li>
<li>Review the source code changes.</li>
<li>Engage with other Live Share developers on <a href="https://stackoverflow.com/questions/tagged/live-share">StackOverflow</a>.</li>
<li><a href="../../CONTRIBUTING.md">Contribute bug fixes</a>.</li>
</ul>
<p>This project has adopted the <a href="https://opensource.microsoft.com/codeofconduct/">Microsoft Open Source Code of Conduct</a>. For more information see the <a href="https://opensource.microsoft.com/codeofconduct/faq/">Code of Conduct FAQ</a> or contact <a href="mailto:opencode@microsoft.com">opencode@microsoft.com</a> with any additional questions or comments.</p>
<a id="md:reporting-security-issues" class="tsd-anchor"></a><h2><a href="#md:reporting-security-issues">Reporting Security Issues</a></h2><p>Security issues and bugs should be reported privately, via email, to the Microsoft Security Response Center (MSRC) at <a href="mailto:secure@microsoft.com">secure@microsoft.com</a>. You should receive a response within 24 hours. If for some reason you do not, please follow up via email to ensure we received your original message. Further information, including the <a href="https://technet.microsoft.com/security/dn606155">MSRC PGP</a> key, can be found in the <a href="https://technet.microsoft.com/security/default">Security TechCenter</a>.</p>
<p>Copyright (c) Microsoft Corporation. All rights reserved.</p>
<p>Licensed under a special <a href="../../LICENSE">Microsoft</a> License.</p>
</section></div>
<div class="col-sidebar">
<div class="page-menu">
<div class="tsd-navigation settings">
<details class="tsd-index-accordion"><summary class="tsd-accordion-summary">
<h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M4.93896 8.531L12 15.591L19.061 8.531L16.939 6.409L12 11.349L7.06098 6.409L4.93896 8.531Z" fill="var(--color-text)"></path></svg>Settings</h3></summary>
<div class="tsd-accordion-details">
<div class="tsd-filter-visibility">
<h4 class="uppercase">Member Visibility</h4><form>
<ul id="tsd-filter-options">
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li></ul></form></div>
<div class="tsd-theme-toggle">
<h4 class="uppercase">Theme</h4><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div>
<details open class="tsd-index-accordion tsd-page-navigation"><summary class="tsd-accordion-summary">
<h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M4.93896 8.531L12 15.591L19.061 8.531L16.939 6.409L12 11.349L7.06098 6.409L4.93896 8.531Z" fill="var(--color-text)"></path></svg>On This Page</h3></summary>
<div class="tsd-accordion-details">
<ul>
<li>
<ul>
<li><a href="#md:live-share-react"><span>Live <wbr/>Share <wbr/>React</span></a></li>
<li>
<ul>
<li><a href="#md:getting-started"><span>Getting started</span></a></li>
<li><a href="#md:installing"><span>Installing</span></a></li>
<li>
<ul>
<li><a href="#md:building-package"><span>Building package</span></a></li>
<li><a href="#md:sample-app"><span>Sample app</span></a></li></ul></li>
<li><a href="#md:live-share-react-vs-vanilla-fluid"><span>Live <wbr/>Share <wbr/>React vs. <wbr/>Vanilla <wbr/>Fluid</span></a></li>
<li><a href="#md:types-of-hooks"><span>Types of hooks</span></a></li>
<li>
<ul>
<li><a href="#md:usesharedstate"><span>use<wbr/>Shared<wbr/>State</span></a></li>
<li><a href="#md:usesharedmap"><span>use<wbr/>Shared<wbr/>Map</span></a></li>
<li><a href="#md:uselivepresence"><span>use<wbr/>Live<wbr/>Presence</span></a></li>
<li><a href="#md:uselivestate"><span>use<wbr/>Live<wbr/>State</span></a></li>
<li><a href="#md:useliveevent"><span>use<wbr/>Live<wbr/>Event</span></a></li>
<li><a href="#md:uselivetimer"><span>use<wbr/>Live<wbr/>Timer</span></a></li>
<li><a href="#md:usemediasynchronizer"><span>use<wbr/>Media<wbr/>Synchronizer</span></a></li>
<li><a href="#md:uselivecanvas"><span>use<wbr/>Live<wbr/>Canvas</span></a></li>
<li><a href="#md:usetaskmanager"><span>use<wbr/>Task<wbr/>Manager</span></a></li>
<li><a href="#md:custom-fluid-object-hooks"><span>Custom <wbr/>Fluid object hooks</span></a></li></ul></li>
<li><a href="#md:code-samples"><span>Code samples</span></a></li>
<li><a href="#md:react-version-compatibility"><span>React version compatibility</span></a></li>
<li><a href="#md:package-compatibility"><span>Package <wbr/>Compatibility</span></a></li>
<li><a href="#md:contributing"><span>Contributing</span></a></li>
<li><a href="#md:reporting-security-issues"><span>Reporting <wbr/>Security <wbr/>Issues</span></a></li></ul></li></ul></li></ul></div></details></div>
<div class="site-menu">
<nav class="tsd-navigation"><a href="../index.html"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><rect fill="var(--color-icon-background)" stroke="var(--color-ts-namespace)" stroke-width="1.5" x="1" y="1" width="22" height="22" rx="6" id="icon-4-path"></rect><path d="M9.33 16V7.24H10.77L13.446 14.74C13.43 14.54 13.41 14.296 13.386 14.008C13.37 13.712 13.354 13.404 13.338 13.084C13.33 12.756 13.326 12.448 13.326 12.16V7.24H14.37V16H12.93L10.266 8.5C10.282 8.692 10.298 8.936 10.314 9.232C10.33 9.52 10.342 9.828 10.35 10.156C10.366 10.476 10.374 10.784 10.374 11.08V16H9.33Z" fill="var(--color-text)" id="icon-4-text"></path></svg><span>Microsoft <wbr/>Live <wbr/>Share SDK</span></a>
<ul class="tsd-small-nested-navigation">
<li><a href="_microsoft_live_share.html"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-4-path"></use><use href="#icon-4-text"></use></svg><span>@microsoft/live-<wbr/>share</span></a></li>
<li><a href="_microsoft_live_share_canvas.html"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-4-path"></use><use href="#icon-4-text"></use></svg><span>@microsoft/live-<wbr/>share-<wbr/>canvas</span></a></li>
<li><a href="_microsoft_live_share_media.html"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-4-path"></use><use href="#icon-4-text"></use></svg><span>@microsoft/live-<wbr/>share-<wbr/>media</span></a></li>
<li><a href="_microsoft_live_share_react.html" class="current"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-4-path"></use><use href="#icon-4-text"></use></svg><span>@microsoft/live-<wbr/>share-<wbr/>react</span></a></li></ul></nav></div></div></div>
<div class="tsd-generator">
<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div>
<div class="overlay"></div></body></html>